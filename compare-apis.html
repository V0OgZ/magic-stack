<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÆ‚ú® Heroes of Time - API Comparison ‚ú®üîÆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .api-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
        }
        
        .java-panel {
            border-left: 5px solid #f89820;
        }
        
        .rust-panel {
            border-left: 5px solid #ce422b;
        }
        
        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .panel-header h2 {
            margin: 0;
            font-size: 1.8em;
        }
        
        .status {
            margin-left: auto;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .status.online {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.offline {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .api-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .endpoints {
            margin-top: 20px;
        }
        
        .endpoint {
            background: #ffffff;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .endpoint-header {
            background: #f8f9fa;
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
        }
        
        .method {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .method.get {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .method.post {
            background: #d4edda;
            color: #155724;
        }
        
        .endpoint-path {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .endpoint-body {
            padding: 15px;
        }
        
        .endpoint-description {
            color: #666;
            margin-bottom: 10px;
        }
        
        .test-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: transform 0.2s;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
        }
        
        .comparison {
            grid-column: 1 / -1;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .comparison h3 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        .comparison-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîÆ‚ú® Heroes of Time - API Comparison ‚ú®üîÆ</h1>
        <p>‚òï Java Backend vs ü¶Ä Rust Backend - Architecture Hybride</p>
    </div>

    <div class="container">
        <!-- Java Backend Panel -->
        <div class="api-panel java-panel">
            <div class="panel-header">
                <h2>‚òï Java Backend</h2>
                <div class="status" id="java-status">Checking...</div>
            </div>
            
            <div class="api-info">
                <strong>Port:</strong> 8080<br>
                <strong>Couches:</strong> Strategic Map, Combat TCG, Narrative Interstice<br>
                <strong>Sp√©cialit√©:</strong> Game Controller & Gameplay
            </div>
            
            <div class="endpoints" id="java-endpoints">
                <div class="loading">Loading Java API...</div>
            </div>
        </div>

        <!-- Rust Backend Panel -->
        <div class="api-panel rust-panel">
            <div class="panel-header">
                <h2>ü¶Ä Rust Backend</h2>
                <div class="status" id="rust-status">Checking...</div>
            </div>
            
            <div class="api-info">
                <strong>Port:</strong> 3001<br>
                <strong>Couches:</strong> MagicStack 6D<br>
                <strong>Sp√©cialit√©:</strong> Recherche spatiotemporelle ultra-rapide
            </div>
            
            <div class="endpoints" id="rust-endpoints">
                <div class="loading">Loading Rust API...</div>
            </div>
        </div>
    </div>

    <div class="comparison">
        <h3>üìä Comparaison des Architectures</h3>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Aspect</th>
                    <th>‚òï Java Backend</th>
                    <th>ü¶Ä Rust Backend</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Performance</strong></td>
                    <td>Optimis√©e pour gameplay</td>
                    <td>Ultra-rapide < 5ms</td>
                </tr>
                <tr>
                    <td><strong>Couches</strong></td>
                    <td>1-3: Strategic, Combat, Narrative</td>
                    <td>4: MagicStack 6D</td>
                </tr>
                <tr>
                    <td><strong>Sp√©cialisation</strong></td>
                    <td>Game Controller, TCG, Interstice</td>
                    <td>Recherche 6D, Q*, Formules</td>
                </tr>
                <tr>
                    <td><strong>Frontend 3D</strong></td>
                    <td>‚úÖ Ready (Phase 1)</td>
                    <td>‚ö° Advanced (Phase 3)</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // Check backend status and load APIs
        async function checkBackendStatus(url, statusElementId) {
            const statusElement = document.getElementById(statusElementId);
            try {
                const response = await fetch(url);
                if (response.ok) {
                    statusElement.textContent = 'ONLINE';
                    statusElement.className = 'status online';
                    return true;
                } else {
                    statusElement.textContent = 'OFFLINE';
                    statusElement.className = 'status offline';
                    return false;
                }
            } catch (error) {
                statusElement.textContent = 'OFFLINE';
                statusElement.className = 'status offline';
                return false;
            }
        }

        async function loadApiSpec(url, endpointsElementId) {
            const endpointsElement = document.getElementById(endpointsElementId);
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error('API not available');
                
                const apiSpec = await response.json();
                displayEndpoints(apiSpec, endpointsElement);
            } catch (error) {
                endpointsElement.innerHTML = `<div class="error">‚ùå API non disponible: ${error.message}</div>`;
            }
        }

        function displayEndpoints(apiSpec, container) {
            const paths = apiSpec.paths || {};
            let html = '';

            for (const [path, methods] of Object.entries(paths)) {
                for (const [method, details] of Object.entries(methods)) {
                    html += `
                        <div class="endpoint">
                            <div class="endpoint-header">
                                <span class="method ${method.toLowerCase()}">${method.toUpperCase()}</span>
                                <span class="endpoint-path">${path}</span>
                            </div>
                            <div class="endpoint-body">
                                <div class="endpoint-description">${details.description || details.summary || 'No description'}</div>
                                <button class="test-button" onclick="testEndpoint('${method}', '${path}')">
                                    üß™ Test
                                </button>
                            </div>
                        </div>
                    `;
                }
            }

            container.innerHTML = html || '<div class="loading">No endpoints found</div>';
        }

        function testEndpoint(method, path) {
            // Simple test function - could be expanded
            const port = path.includes('api') ? (path.includes('search') ? '3001' : '8080') : 
                         (document.getElementById('java-status').textContent === 'ONLINE' ? '8080' : '3001');
            const url = `http://localhost:${port}${path}`;
            
            if (method === 'GET') {
                window.open(url, '_blank');
            } else {
                alert(`Test ${method} ${url}\n\nUtilisez curl ou Postman pour tester les endpoints POST`);
            }
        }

        // Initialize
        async function init() {
            // Check statuses
            const javaOnline = await checkBackendStatus('http://localhost:8082/health', 'java-status');
            const rustOnline = await checkBackendStatus('http://localhost:3001/health', 'rust-status');

            // Load API specs
            if (javaOnline) {
                await loadApiSpec('http://localhost:8082/openapi', 'java-endpoints');
            } else {
                document.getElementById('java-endpoints').innerHTML = '<div class="error">‚ùå Backend Java offline</div>';
            }

            if (rustOnline) {
                await loadApiSpec('http://localhost:3001/openapi', 'rust-endpoints');
            } else {
                document.getElementById('rust-endpoints').innerHTML = '<div class="error">‚ùå Backend Rust offline</div>';
            }
        }

        // Start initialization
        init();

        // Auto-refresh every 30 seconds
        setInterval(init, 30000);
    </script>
</body>
</html>