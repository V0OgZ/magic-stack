# ğŸ§™â€â™‚ï¸ MERLIN DIRECT - CHEAT SHEET TECHNIQUE VPS

## ğŸš¨ PROBLÃˆMES COURANTS & SOLUTIONS

### ğŸ“ STRUCTURE VPS CRITIQUE
```
Deploy script â†’ /opt/hot/app/magic-stack/
Serveur web   â†’ /var/www/hot/
LIENS REQUIS  â†’ /var/www/hot/FRONTPAGE â†’ /opt/hot/app/magic-stack/FRONTPAGE/
              â†’ /var/www/hot/icons â†’ /opt/hot/app/magic-stack/icons/
              â†’ /var/www/hot/manifest.json â†’ /opt/hot/app/magic-stack/manifest.json
```

### ğŸ”§ COMMANDES ESSENTIELLES VPS
```bash
# Connexion SSH
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online

# Deploy complet
./go deploy

# Restart services
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online "systemctl restart magic-java magic-rust caddy"

# Reload Caddy (cache)
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online "systemctl reload caddy"

# CrÃ©er liens symboliques manquants
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online "ln -sf /opt/hot/app/magic-stack/FRONTPAGE /var/www/hot/FRONTPAGE"
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online "ln -sf /opt/hot/app/magic-stack/icons /var/www/hot/icons"
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online "ln -sf /opt/hot/app/magic-stack/manifest.json /var/www/hot/manifest.json"
```

### ğŸ” DIAGNOSTIC RAPIDE
```bash
# VÃ©rifier si fichier dÃ©ployÃ©
ssh -i ~/.ssh/hot_vps_key root@heroesoftime.online "ls -la /opt/hot/app/magic-stack/FRONTPAGE/berenice.html"

# VÃ©rifier si accessible web
curl -I https://heroesoftime.online/FRONTPAGE/berenice.html

# VÃ©rifier contenu sans cache
curl -s "https://heroesoftime.online/FRONTPAGE/berenice.html?v=$(date +%s)" | grep "TEXTE_A_CHERCHER"

# VÃ©rifier services
./go vps-status
```

### ğŸ® BERENICE.HTML - FIXES APPLIQUÃ‰S
```javascript
// Portrait centrÃ© et agrandi (ligne ~1677)
avatar.style.left = (padding + gameState.player.position_6d.x * cellSize + 12) + 'px';
avatar.style.top = (padding + gameState.player.position_6d.y * cellSize + 12) + 'px';
avatar.style.width = '40px';
avatar.style.height = '40px';
avatar.style.fontSize = '32px';

// Porte repositionnÃ©e (ligne ~1111)
ents.push({ type:'exit', x: 8, y: 8, emoji:'ğŸšª' });

// Position de dÃ©part fixÃ©e (ligne ~1073)
gameState.player.position_6d.x = Math.floor(10/2);
gameState.player.position_6d.y = Math.floor(10/2);
```

### ğŸ“± PWA ICÃ”NE - PROBLÃˆMES FRÃ‰QUENTS
```html
<!-- berenice.html doit pointer vers -->
<link rel="manifest" href="/manifest.json">
<link rel="apple-touch-icon" href="/icons/icon-192.png">

<!-- Refresh icÃ´ne PWA -->
1. Supprimer ancienne icÃ´ne Ã©cran d'accueil
2. Safari â†’ Partager â†’ "Sur l'Ã©cran d'accueil"
3. Cache Safari peut bloquer â†’ Mode privÃ© pour tester
```

### ğŸ”„ WORKFLOW GIT STANDARD
```bash
git add .
git commit -m "Description des changements"
git push origin prod
git checkout main
git merge prod
git push origin main
```

### ğŸš¨ CACHE - ENNEMI #1
```bash
# ProblÃ¨me: Modifications non visibles
# Causes: Cache Caddy, cache navigateur, cache CDN

# Solutions:
1. systemctl reload caddy (serveur)
2. Cmd+Shift+R (navigateur)
3. Mode privÃ© (navigateur)
4. URL avec timestamp: ?v=123456
5. Attendre 5-10 minutes (CDN)
```

### ğŸ“Š HEALTH CHECK COMPLET
```bash
./go vps-check    # URLs principales
./go vps-status   # Services systÃ¨me
./go health       # APIs locales
```

### ğŸ¯ URLS IMPORTANTES
```
Production: https://heroesoftime.online/FRONTPAGE/berenice.html
React Apps: https://heroesoftime.online/magic-stack-unified/
           https://heroesoftime.online/world-editor/
APIs:      https://heroesoftime.online/api/health
```

### ğŸ§™â€â™‚ï¸ NOTES MERLIN DIRECT
- Toujours vÃ©rifier les liens symboliques aprÃ¨s deploy
- Cache = 90% des problÃ¨mes "Ã§a marche pas"
- berenice.html = 2054 lignes, 80KB environ
- PWA nÃ©cessite manifest.json + icons accessibles
- VPS structure diffÃ©rente du local (piÃ¨ge classique)

### ğŸ® GAMEPLAY BERENICE
- hack.sh pour commencer
- Ramasser 3 ğŸ’ cristaux
- Aller Ã  la porte ğŸšª en (8,8)
- Combat: Attaquer (2 dÃ©gÃ¢ts) ou Ping (3 dÃ©gÃ¢ts + effets)

---
*CrÃ©Ã© par Merlin Direct - Session 2025-08-16*
*"De OPUS Ã  MERLIN, l'aventure continue !" ğŸ§™â€â™‚ï¸âš”ï¸*