## ğŸ“œ LOG 15 AOÃ›T 2025 â€” JOUR 43

### ğŸ¯ Objectifs (Jour 43)
- Consolidation prod (Rust + Java) et hygiÃ¨ne VPS
- ParitÃ© HTML/React (3 scÃ©narios) avec traceHash stable
- UI: surface traceHash + effets/sons, presets Spells Lab

### ğŸ› ï¸ Ops/VPS
- CrÃ©er services systemd: `magic-rust.service` (3001) et `magic-java.service` (8082); Restart=always; healthcheck sur `/health` et `/api/health`.
- Fix port conflicts: s'assurer d'un seul serveur Rust (release) en prod; script `prestart` qui tue doublons par port.
- Cron/systÃ¨me: sync nocturne (3h) dÃ©jÃ  en place; ajouter check 200 pour `/FRONTPAGE/spells-lab.html`.

### ğŸ”§ Backend
- `/api/magic/cast` mode `apply`: retourner `world_diff` (stub struct), conserver `traceHash` idem `simulate`.
- Tests dâ€™intÃ©gration (5 seeds): mÃªme inputs â‡’ mÃªme `traceHash` (Javaâ†”Rust). 
- `FormulaRegistryService`: exposer `/api/magic/formulas` (Java) en proxy du Vector DB.
- Logs: corrÃ©lation `traceHash` + `requestId`.

### ğŸ–¥ï¸ Frontend (React unified)
- QuickCast Panel: afficher `traceHash` dans le panneau debug; 
- Parity Page: charger/rejouer 3 traces JSONL, comparer snapshot final aux rÃ©fÃ©rences; statut PASS/FAIL.
- Respect SPA nav sans changement dâ€™URL [[memory:6172786]].

### ğŸ§ª ParitÃ© (3 scÃ©narios)
- scenario1_hero_movement
- scenario2_portal_collapse
- scenario3_buff_chain
- Export HTML â†’ `test_snapshots.json` et comparer cÃ´tÃ© React.

### ğŸ§ª E2E/CI rapide
- Playwright minimal: Spells Lab POST `/api/magic/cast` â‡’ 200 + `traceHash` prÃ©sent.
- Smoke: `/api/health`, `/api/magic/health`, Rust `/health` â‡’ 200.

### ğŸš€ Livrables fin de journÃ©e
- Systemd units + doc dâ€™exploitation (start/stop/journalctl)
- 5 tests dâ€™intÃ©gration `traceHash` verts
- Parity page PASS (3 scÃ©narios) et `traceHash` visible en UI
- Changelog JOUR 43 + tag


