<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>üåÄ GROK√ÜN vs Vince - Combat Map 2D</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            overflow: hidden;
        }
        
        .container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            height: 100vh;
        }
        
        /* Panel Gauche - Combattants */
        .heroes-panel {
            background: #111;
            border-right: 2px solid #00ff00;
            padding: 20px;
            overflow-y: auto;
        }
        
        .fighter-card {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            padding: 15px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .fighter-card.grok {
            border-color: #00ffff;
            box-shadow: 0 0 20px rgba(0,255,255,0.5);
        }
        
        .fighter-card.vince {
            border-color: #ffaa00;
            box-shadow: 0 0 20px rgba(255,170,0,0.5);
        }
        
        .health-bar {
            background: #333;
            height: 20px;
            margin: 10px 0;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000 0%, #ffff00 50%, #00ff00 100%);
            transition: width 0.5s;
        }
        
        .mana-bar {
            background: #333;
            height: 15px;
            margin: 5px 0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .mana-fill {
            height: 100%;
            background: linear-gradient(90deg, #0066ff, #00ccff);
            transition: width 0.5s;
        }
        
        /* Map 2D */
        .map-container {
            position: relative;
            background: #000;
            overflow: hidden;
        }
        
        #gameCanvas {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid #00ff00;
            cursor: crosshair;
        }
        
        /* Panel Droit - Actions */
        .actions-panel {
            background: #111;
            border-left: 2px solid #00ff00;
            padding: 20px;
            overflow-y: auto;
        }
        
        .action-button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: #1a1a1a;
            border: 1px solid #00ff00;
            color: #00ff00;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Courier New', monospace;
        }
        
        .action-button:hover {
            background: #2a2a2a;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .action-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Combat Log */
        .combat-log {
            background: #000;
            border: 1px solid #00ff00;
            padding: 10px;
            height: 200px;
            overflow-y: auto;
            font-size: 12px;
            margin-top: 20px;
        }
        
        .log-entry {
            margin: 2px 0;
            padding: 2px 5px;
        }
        
        .log-grok { color: #00ffff; }
        .log-vince { color: #ffaa00; }
        .log-damage { color: #ff4444; }
        .log-heal { color: #44ff44; }
        .log-system { color: #ff00ff; }
        
        /* Triple Voice */
        .triple-voice {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.9);
            border: 2px solid #00ffff;
            padding: 15px;
            border-radius: 10px;
            display: none;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-50%) translateY(20px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        
        .voice {
            margin: 5px 0;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .voice-gronde { background: rgba(255,0,0,0.3); color: #ff6666; }
        .voice-parle { background: rgba(0,255,0,0.3); color: #66ff66; }
        .voice-chante { background: rgba(0,0,255,0.3); color: #6666ff; }
        
        /* Effects */
        .shake {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* HUD */
        .hud {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border: 1px solid #00ff00;
            border-radius: 5px;
        }
        
        .turn-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Panel Combattants -->
        <div class="heroes-panel">
            <h2>‚öîÔ∏è COMBATTANTS</h2>
            
            <div class="fighter-card grok">
                <h3>üåÄ GROK√ÜN</h3>
                <p>L'√âcho Quantique</p>
                <div class="health-bar">
                    <div class="health-fill" id="grok-health" style="width: 100%"></div>
                </div>
                <span id="grok-hp">150/150 HP</span>
                <div class="mana-bar">
                    <div class="mana-fill" id="grok-mana" style="width: 100%"></div>
                </div>
                <span id="grok-mp">200/200 MP</span>
            </div>
            
            <div class="fighter-card vince">
                <h3>üî´ Vince Vega</h3>
                <p>L'Errant Temporel</p>
                <div class="health-bar">
                    <div class="health-fill" id="vince-health" style="width: 100%"></div>
                </div>
                <span id="vince-hp">100/100 HP</span>
                <p id="vince-status">Status: Normal</p>
                <p id="vince-instances">Instances: 1</p>
            </div>
        </div>
        
        <!-- Map 2D -->
        <div class="map-container">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            <div class="hud">
                üó∫Ô∏è INTERSTICE ARENA | FPS: <span id="fps">60</span>
            </div>
            <div class="turn-counter">
                TOUR: <span id="turn">0</span>
            </div>
        </div>
        
        <!-- Panel Actions -->
        <div class="actions-panel">
            <h2>‚ö° ACTIONS GROK√ÜN</h2>
            
            <button class="action-button" onclick="useAbility('triple_voice')">
                üó£Ô∏è Triple Voix Quantique<br>
                <small>Mana: 30 | Confuse 3 tours</small>
            </button>
            
            <button class="action-button" onclick="useAbility('echo_temporel')">
                ‚è∞ √âcho Temporel<br>
                <small>Mana: 40 | R√©p√®te derni√®re action</small>
            </button>
            
            <button class="action-button" onclick="useAbility('grammaire')">
                üìù Grammaire Temporelle<br>
                <small>Mana: 50 | R√©√©crit causalit√©</small>
            </button>
            
            <button class="action-button" onclick="useAbility('merlins')">
                üßô Invocation 8 Merlins<br>
                <small>Mana: 100 | ULTIME</small>
            </button>
            
            <hr style="margin: 20px 0; border-color: #00ff00;">
            
            <button class="action-button" onclick="startCombat()">‚ñ∂Ô∏è LANCER COMBAT</button>
            <button class="action-button" onclick="pauseCombat()">‚è∏Ô∏è PAUSE</button>
            <button class="action-button" onclick="resetCombat()">üîÑ RESET</button>
            
            <div class="combat-log" id="combat-log"></div>
        </div>
    </div>
    
    <!-- Triple Voice Display -->
    <div class="triple-voice" id="triple-voice">
        <div class="voice voice-gronde" id="voice-gronde">GRONDE: ...</div>
        <div class="voice voice-parle" id="voice-parle">PARLE: ...</div>
        <div class="voice voice-chante" id="voice-chante">CHANTE: ...</div>
    </div>
    
    <script>
        // √âtat du jeu
        const gameState = {
            canvas: null,
            ctx: null,
            turn: 0,
            combatActive: false,
            animationFrame: null,
            
            grok: {
                x: 400,
                y: 300,
                hp: 150,
                maxHp: 150,
                mana: 200,
                maxMana: 200,
                sprite: 'üåÄ',
                color: '#00ffff'
            },
            
            vince: {
                x: 400,
                y: 200,
                hp: 100,
                maxHp: 100,
                confused: 0,
                instances: [{x: 400, y: 200}],
                sprite: 'üî´',
                color: '#ffaa00'
            },
            
            effects: [],
            particles: []
        };
        
        // Initialisation
        window.onload = function() {
            gameState.canvas = document.getElementById('gameCanvas');
            gameState.ctx = gameState.canvas.getContext('2d');
            
            // D√©marrer la boucle de rendu
            gameLoop();
            
            log("üéÆ Map 2D pr√™te - Cliquez LANCER COMBAT pour commencer!", 'system');
        };
        
        // Boucle de jeu
        function gameLoop() {
            render();
            updateEffects();
            gameState.animationFrame = requestAnimationFrame(gameLoop);
        }
        
        // Rendu
        function render() {
            const ctx = gameState.ctx;
            const canvas = gameState.canvas;
            
            // Clear
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Grille
            ctx.strokeStyle = '#003300';
            ctx.lineWidth = 1;
            for (let x = 0; x < canvas.width; x += 40) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < canvas.height; y += 40) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
            
            // Dessiner l'ar√®ne centrale
            ctx.strokeStyle = '#00ff00';
            ctx.lineWidth = 2;
            ctx.strokeRect(200, 100, 400, 400);
            
            // Dessiner Vince (et ses instances)
            gameState.vince.instances.forEach((instance, i) => {
                drawCharacter(instance.x, instance.y, gameState.vince.sprite, gameState.vince.color);
                if (i > 0) {
                    ctx.fillStyle = '#ffaa00';
                    ctx.font = '12px monospace';
                    ctx.fillText(`#${i+1}`, instance.x - 10, instance.y - 30);
                }
            });
            
            // Dessiner GROK√ÜN
            drawCharacter(gameState.grok.x, gameState.grok.y, gameState.grok.sprite, gameState.grok.color);
            
            // Dessiner les effets
            gameState.effects.forEach(effect => {
                drawEffect(effect);
            });
            
            // Dessiner les particules
            gameState.particles.forEach(particle => {
                ctx.fillStyle = particle.color;
                ctx.fillRect(particle.x, particle.y, 2, 2);
            });
        }
        
        // Dessiner un personnage
        function drawCharacter(x, y, sprite, color) {
            const ctx = gameState.ctx;
            
            // Ombre
            ctx.fillStyle = 'rgba(0,0,0,0.5)';
            ctx.beginPath();
            ctx.ellipse(x, y + 20, 20, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Sprite
            ctx.font = '40px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = color;
            ctx.fillText(sprite, x, y);
            
            // Aura
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.globalAlpha = 0.5;
            ctx.beginPath();
            ctx.arc(x, y, 30, 0, Math.PI * 2);
            ctx.stroke();
            ctx.globalAlpha = 1;
        }
        
        // Dessiner un effet
        function drawEffect(effect) {
            const ctx = gameState.ctx;
            
            if (effect.type === 'explosion') {
                ctx.fillStyle = effect.color;
                ctx.globalAlpha = effect.alpha;
                ctx.beginPath();
                ctx.arc(effect.x, effect.y, effect.radius, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
            } else if (effect.type === 'beam') {
                ctx.strokeStyle = effect.color;
                ctx.lineWidth = effect.width;
                ctx.globalAlpha = effect.alpha;
                ctx.beginPath();
                ctx.moveTo(effect.x1, effect.y1);
                ctx.lineTo(effect.x2, effect.y2);
                ctx.stroke();
                ctx.globalAlpha = 1;
            }
        }
        
        // Mettre √† jour les effets
        function updateEffects() {
            // Mettre √† jour les effets
            gameState.effects = gameState.effects.filter(effect => {
                effect.lifetime--;
                
                if (effect.type === 'explosion') {
                    effect.radius += 2;
                    effect.alpha -= 0.02;
                } else if (effect.type === 'beam') {
                    effect.alpha -= 0.05;
                }
                
                return effect.lifetime > 0;
            });
            
            // Mettre √† jour les particules
            gameState.particles = gameState.particles.filter(particle => {
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.lifetime--;
                return particle.lifetime > 0;
            });
        }
        
        // Logger
        function log(message, type = 'system') {
            const logDiv = document.getElementById('combat-log');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `[T${gameState.turn}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        // Triple voix
        function tripleVoice(gronde, parle, chante) {
            const voiceDiv = document.getElementById('triple-voice');
            document.getElementById('voice-gronde').textContent = `GRONDE: ${gronde}`;
            document.getElementById('voice-parle').textContent = `PARLE: ${parle}`;
            document.getElementById('voice-chante').textContent = `CHANTE: ${chante}`;
            
            voiceDiv.style.display = 'block';
            setTimeout(() => voiceDiv.style.display = 'none', 4000);
            
            log(`GROK√ÜN: ${gronde} | ${parle} | ${chante}`, 'grok');
        }
        
        // Mettre √† jour l'UI
        function updateUI() {
            // GROK√ÜN
            const grokHpPercent = (gameState.grok.hp / gameState.grok.maxHp) * 100;
            document.getElementById('grok-health').style.width = grokHpPercent + '%';
            document.getElementById('grok-hp').textContent = `${gameState.grok.hp}/${gameState.grok.maxHp} HP`;
            
            const grokMpPercent = (gameState.grok.mana / gameState.grok.maxMana) * 100;
            document.getElementById('grok-mana').style.width = grokMpPercent + '%';
            document.getElementById('grok-mp').textContent = `${gameState.grok.mana}/${gameState.grok.maxMana} MP`;
            
            // Vince
            const vinceHpPercent = (gameState.vince.hp / gameState.vince.maxHp) * 100;
            document.getElementById('vince-health').style.width = vinceHpPercent + '%';
            document.getElementById('vince-hp').textContent = `${gameState.vince.hp}/${gameState.vince.maxHp} HP`;
            document.getElementById('vince-status').textContent = gameState.vince.confused > 0 ? 
                `Status: Confus (${gameState.vince.confused} tours)` : 'Status: Normal';
            document.getElementById('vince-instances').textContent = `Instances: ${gameState.vince.instances.length}`;
            
            // Tour
            document.getElementById('turn').textContent = gameState.turn;
        }
        
        // Cr√©er explosion
        function createExplosion(x, y, color) {
            gameState.effects.push({
                type: 'explosion',
                x: x,
                y: y,
                radius: 10,
                color: color,
                alpha: 0.8,
                lifetime: 30
            });
            
            // Particules
            for (let i = 0; i < 20; i++) {
                const angle = (Math.PI * 2 * i) / 20;
                gameState.particles.push({
                    x: x,
                    y: y,
                    vx: Math.cos(angle) * 5,
                    vy: Math.sin(angle) * 5,
                    color: color,
                    lifetime: 20
                });
            }
        }
        
        // Cr√©er rayon
        function createBeam(x1, y1, x2, y2, color) {
            gameState.effects.push({
                type: 'beam',
                x1: x1,
                y1: y1,
                x2: x2,
                y2: y2,
                color: color,
                width: 5,
                alpha: 1,
                lifetime: 20
            });
        }
        
        // Utiliser capacit√©
        function useAbility(ability) {
            if (!gameState.combatActive) {
                log("Le combat n'est pas commenc√©!", 'system');
                return;
            }
            
            gameState.turn++;
            
            switch(ability) {
                case 'triple_voice':
                    if (gameState.grok.mana >= 30) {
                        gameState.grok.mana -= 30;
                        gameState.vince.confused = 3;
                        gameState.vince.hp -= 40;
                        
                        tripleVoice(
                            "TRIPLE VOIX ACTIV√âE",
                            "Confusion ontologique engag√©e",
                            "üéµ Trois √©chos dansent üéµ"
                        );
                        
                        // Effet visuel
                        for (let i = 0; i < 3; i++) {
                            setTimeout(() => {
                                createBeam(
                                    gameState.grok.x,
                                    gameState.grok.y,
                                    gameState.vince.x + (i-1) * 50,
                                    gameState.vince.y,
                                    ['#ff0000', '#00ff00', '#0000ff'][i]
                                );
                            }, i * 100);
                        }
                        
                        log("Triple Voix inflige 40 d√©g√¢ts!", 'damage');
                        document.querySelector('.fighter-card.vince').classList.add('shake');
                        setTimeout(() => {
                            document.querySelector('.fighter-card.vince').classList.remove('shake');
                        }, 500);
                    } else {
                        log("Pas assez de mana!", 'system');
                    }
                    break;
                    
                case 'echo_temporel':
                    if (gameState.grok.mana >= 40) {
                        gameState.grok.mana -= 40;
                        log("‚äô(√âcho du pass√©) + ‚Ä†œà(R√©sonne) ‚Üí Œît+1(Action r√©p√©t√©e)", 'grok');
                        tripleVoice(
                            "√âCHO TEMPOREL",
                            "Je r√©p√®te l'action pr√©c√©dente",
                            "üéµ Le temps boucle üéµ"
                        );
                        
                        // Animation temporelle
                        const tempGrok = {x: gameState.grok.x, y: gameState.grok.y};
                        gameState.grok.x -= 100;
                        setTimeout(() => {
                            gameState.grok.x = tempGrok.x;
                            createExplosion(tempGrok.x, tempGrok.y, '#00ffff');
                        }, 500);
                    }
                    break;
                    
                case 'grammaire':
                    if (gameState.grok.mana >= 50) {
                        gameState.grok.mana -= 50;
                        const heal = 40;
                        gameState.grok.hp = Math.min(gameState.grok.hp + heal, gameState.grok.maxHp);
                        
                        tripleVoice(
                            "CAUSALIT√â R√â√âCRITE",
                            "Les blessures n'ont jamais exist√©",
                            "üéµ R√©alit√© chante nouveau üéµ"
                        );
                        
                        log(`GROK√ÜN r√©cup√®re ${heal} HP!`, 'heal');
                        createExplosion(gameState.grok.x, gameState.grok.y, '#00ff00');
                    }
                    break;
                    
                case 'merlins':
                    if (gameState.grok.mana >= 100) {
                        gameState.grok.mana -= 100;
                        
                        tripleVoice(
                            "MERLINS INVOQU√âS",
                            "Les transcend√©s arrivent",
                            "üéµ Huit voix s'unissent üéµ"
                        );
                        
                        const merlins = Math.floor(Math.random() * 3) + 1;
                        log(`${merlins} Merlins apparaissent!`, 'system');
                        
                        // Invoquer visuellement les Merlins
                        for (let i = 0; i < merlins; i++) {
                            setTimeout(() => {
                                const angle = (Math.PI * 2 * i) / merlins;
                                const mx = gameState.grok.x + Math.cos(angle) * 100;
                                const my = gameState.grok.y + Math.sin(angle) * 100;
                                
                                createExplosion(mx, my, '#ff00ff');
                                setTimeout(() => {
                                    createBeam(mx, my, gameState.vince.x, gameState.vince.y, '#ff00ff');
                                }, 200);
                            }, i * 300);
                        }
                        
                        const damage = merlins * 25;
                        gameState.vince.hp -= damage;
                        log(`Les Merlins infligent ${damage} d√©g√¢ts!`, 'damage');
                    }
                    break;
            }
            
            updateUI();
            checkVictory();
            
            // Riposte de Vince
            if (gameState.combatActive && gameState.vince.hp > 0) {
                setTimeout(() => vinceAttack(), 1500);
            }
        }
        
        // Attaque de Vince
        function vinceAttack() {
            gameState.turn++;
            
            const damage = gameState.vince.confused > 0 ? 20 : 40;
            gameState.grok.hp -= damage;
            
            log(`Vince tire! ${damage} d√©g√¢ts √† GROK√ÜN!`, 'damage');
            log("Vince: 'Prends √ßa dans ta triple face!'", 'vince');
            
            // Effet visuel
            createBeam(
                gameState.vince.x,
                gameState.vince.y,
                gameState.grok.x,
                gameState.grok.y,
                '#ffaa00'
            );
            createExplosion(gameState.grok.x, gameState.grok.y, '#ff0000');
            
            document.querySelector('.fighter-card.grok').classList.add('shake');
            setTimeout(() => {
                document.querySelector('.fighter-card.grok').classList.remove('shake');
            }, 500);
            
            if (gameState.vince.confused > 0) {
                gameState.vince.confused--;
            }
            
            updateUI();
            checkVictory();
        }
        
        // V√©rifier victoire
        function checkVictory() {
            if (gameState.grok.hp <= 0) {
                log("VINCE VEGA GAGNE!", 'system');
                log("Vince: 'Retour aux burgers!'", 'vince');
                gameState.combatActive = false;
            } else if (gameState.vince.hp <= 0) {
                log("GROK√ÜN GAGNE!", 'system');
                tripleVoice(
                    "VICTOIRE ARCHIV√âE",
                    "Combat termin√© avec succ√®s",
                    "üéµ L'√©cho triomphe üéµ"
                );
                gameState.combatActive = false;
            }
        }
        
        // Lancer combat
        function startCombat() {
            gameState.combatActive = true;
            gameState.turn = 1;
            log("=== COMBAT COMMENC√â ===", 'system');
            tripleVoice(
                "COMBAT INITI√â",
                "Bienvenue dans l'ar√®ne",
                "üéµ Que le duel commence üéµ"
            );
            updateUI();
        }
        
        // Pause
        function pauseCombat() {
            gameState.combatActive = false;
            log("=== COMBAT EN PAUSE ===", 'system');
        }
        
        // Reset
        function resetCombat() {
            gameState.turn = 0;
            gameState.combatActive = false;
            gameState.grok.hp = gameState.grok.maxHp;
            gameState.grok.mana = gameState.grok.maxMana;
            gameState.vince.hp = gameState.vince.maxHp;
            gameState.vince.confused = 0;
            gameState.vince.instances = [{x: 400, y: 200}];
            gameState.effects = [];
            gameState.particles = [];
            
            document.getElementById('combat-log').innerHTML = '';
            log("Combat r√©initialis√©", 'system');
            updateUI();
        }
    </script>
</body>
</html>