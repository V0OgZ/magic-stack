<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>World Editor - Avalon</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: #0a0e27; color: #e8ecff; overflow: hidden; }
    .layout { display: grid; grid-template-columns: 320px 1fr 360px; grid-template-rows: 60px 1fr; grid-template-areas: 'topbar topbar topbar' 'left main right'; height: 100vh; }
    .topbar { grid-area: topbar; background: rgba(0,0,0,0.8); border-bottom: 2px solid #2a5298; display: flex; align-items: center; justify-content: space-between; padding: 0 16px; }
    .left { grid-area: left; background: rgba(255,255,255,0.04); border-right: 1px solid rgba(255,255,255,0.08); overflow: auto; }
    .main { grid-area: main; position: relative; overflow: hidden; }
    .right { grid-area: right; background: rgba(255,255,255,0.04); border-left: 1px solid rgba(255,255,255,0.08); overflow: auto; }
    .section { padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,0.06); }
    .title { font-weight: 700; margin-bottom: 8px; color: #ffd700; }
    .btn { background: linear-gradient(135deg, #667eea, #764ba2); border: none; color: white; padding: 10px 12px; border-radius: 10px; cursor: pointer; }
    .btn:active { transform: scale(0.98); }
    /* Clippy bubble */
    #clippy { position: fixed; bottom: 20px; right: 20px; width: 72px; height: 72px; font-size: 64px; cursor: pointer; z-index: 2000; }
    .clippy-bubble { position: fixed; bottom: 110px; right: 20px; background: linear-gradient(135deg, #fff, #f0f0f0); color: #333; padding: 12px 16px; border-radius: 16px; border: 2px solid #333; max-width: 320px; font-size: 14px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); z-index: 2000; display: none; }
  </style>
</head>
<body>
  <div class="layout">
    <div class="topbar">
      <div>üåç World Editor</div>
      <div style="display:flex; gap:8px;">
        <button class="btn" onclick="Editor.newWorld()">Nouveau Monde</button>
        <button class="btn" onclick="Editor.openDocs()">Docs</button>
        <button class="btn" onclick="Editor.exportJSON()">Exporter</button>
      </div>
    </div>

    <div class="left">
      <div class="section">
        <div class="title">Cartes</div>
        <button class="btn" onclick="Editor.addRegion()">+ R√©gion</button>
      </div>
      <div class="section">
        <div class="title">Timeline</div>
        <button class="btn" onclick="Editor.addEvent()">+ √âv√©nement</button>
      </div>
      <div class="section">
        <div class="title">Param√®tres</div>
        <button class="btn" onclick="Editor.openSettings()">Ouvrir</button>
      </div>
    </div>

    <div class="main" id="canvas">
      <!-- future canvas/hex grid here -->
    </div>

    <div class="right">
      <div class="section">
        <div class="title">Propri√©t√©s</div>
        <div id="properties">S√©lectionnez un √©l√©ment‚Ä¶</div>
      </div>
      <div class="section">
        <div class="title">Console</div>
        <pre id="console" style="white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size: 12px;"></pre>
      </div>
    </div>
  </div>

  <!-- Clippy -->
  <div id="clippy">üìé</div>
  <div class="clippy-bubble" id="clippyBubble"><span id="clippyText">Bienvenue dans l'√©diteur!</span></div>

  <script type="module">
    import { ClippyHelper } from './clippy-helper.js';

    const clippy = new ClippyHelper({
      messages: [
        "Bienvenue! Cr√©e ton monde sans coder üëÜ",
        "Ajoute une r√©gion avec '+ R√©gion'",
        "Timeline: ajoute un √©v√©nement pour le Jour 30",
        "Exporter g√©n√®re le JSON au format officiel",
      ]
    });

    export const Editor = {
      world: {
        id: 'world-dev',
        name: 'Mon Monde',
        map: { size: { x: 60, y: 60 }, regions: [] },
        events: []
      },
      log(msg) {
        const c = document.getElementById('console');
        c.textContent = (c.textContent + (c.textContent ? '\n' : '') + msg).slice(-4000);
      },
      newWorld() {
        this.world = { id: `world-${Date.now()}`, name: 'Nouveau Monde', map: { size: { x: 60, y: 60 }, regions: [] }, events: [] };
        this.log('Nouveau monde cr√©√©');
        clippy.celebrate();
      },
      addRegion() {
        const id = `region-${this.world.map.regions.length + 1}`;
        this.world.map.regions.push({ id, biome: 'forest', fog_level: 0.5 });
        this.log(`R√©gion ajout√©e: ${id}`);
      },
      addEvent() {
        const id = `event-${this.world.events.length + 1}`;
        this.world.events.push({ id, day: 1, type: 'spawn', payload: {} });
        this.log(`√âv√©nement ajout√©: ${id}`);
      },
      openSettings() {
        this.log('Param√®tres ouverts');
      },
      exportJSON() {
        const data = JSON.stringify(this.world, null, 2);
        const blob = new Blob([data], { type: 'application/json' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = `${this.world.id}.json`;
        a.click();
        this.log('Export JSON g√©n√©r√©');
      },
      openDocs() {
        window.open('docs/world-editor/README.md', '_blank');
      }
    };

    window.Editor = Editor;
  </script>
</body>
</html>


